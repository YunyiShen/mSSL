# collection of multivariate Spike-and-Slab LASSO

A collection of multivariate Spike-and-Slab model for different type of responses centered on Gaussian, with effective posterior explorations, by Shen, Solis-Lemus and Deshpande 2022.  

- For continuous data
    - multivariate SSL by [Deshpande et al. 2018](https://arxiv.org/abs/1708.08911), this uses a mean covariance parameterization of Gaussian model
    - chain graphical SSL by Shen, Solis-Lemus and Deshpande 2021+ (not published), uses a Gaussian chain graph parameterization
    - chain graphical VAR(1) SSL described in the same Shen, Solis-Lemus and Deshpande 2021+, uses a Gaussian chain graphical VAR(1) model for time series

- For binary data
    - multivariate probit SSL follows multivariate Spike-and-Slab LASSO by [Deshpande et al. 2018](https://arxiv.org/abs/1708.08911), with an EM algorithm account for the probit structure follows [Gessner et al. 2019](arxiv.org/abs/1910.09328)'s sampling methods. (tested)
    - the chain graphical version of the above

- For counting
    - multivariate STAR SSL (currently only allow fixed links) follows multivariate Spike-and-Slab LASSO by [Deshpande et al. 2018](https://arxiv.org/abs/1708.08911), with EM algorithm described in [Kowal and Canale 2020](arxiv.org/abs/1906.11653)'s STAR model. (unit tested)
    - cg version of the above



It is not yet on CRAN, to install, use:

```r
devtools::install_github("YunyiShen/mSSL")
```

Source code to repeat our experiments in the paper are located in `tests/cgSSL_Formal_simu` [[link]](https://github.com/YunyiShen/mSSL/tree/dev/tests/cgSSL_Formal_simu), folders are for different dimensions. To compare with CARlasso, you need to install `CARlasso` from CRAN first.

For instance, to repeat the simulation on p=10, q=10, n=100 and AR1, use:

```shell
./p10q10n100.sh 12345 1 1
```
There are 3 arguments in the shell, which calls `p10q10n100.R`, the first and second are cluster id and job id, while the sum will be used as random seed to generate the data. The last argument is the number of covariance matrix, 1=AR1, 2=AR2, 3=Block, 4=Star, 6=Dense, 5 is not used. 

Raw data generated by CHTC at UW-Madison, as well as the submit file and shell files are in the `tar.gz` files in each dimension folder.

To reproduce the real data, check the file `real_data/Microbiome/analysis.R`. [[link]](https://github.com/YunyiShen/mSSL/blob/dev/real_data/Micorbiome/analysis.R). 
